import React, { useEffect, useState } from "react";
import classes from "../styles/Header.module.css";
import MainMenu from "./MainMenu";
import SearchCity from "./SearchCity";
import getCityByIp from "../services/fetchIp";

const Header = () => {
	const [citySetting, setCitySetting] = useState({ name: "", lat: "", lon: "" });
	const [isModalOpen, setIsModalOpen] = useState(false);

	useEffect(() => {
		getCityByIp().then((data) => {
			if (data) {
				setCitySetting(data);
			} else {
				setCitySetting({ name: "New York", lat: 53.07, lon: -0.14 });
			}
		});
	}, []);

	return (
		<header className={classes.header + " block"}>
			<div style={{ height: "100%" }}>
				<div className={classes.logo}>
					<svg version="1.1" viewBox="0 0 280 135" id="svg1" className={classes.svg} preserveAspectRatio="none">
						<g id="g2" transform="matrix(0.1171875,0,0,0.11719093,215.32476,13.94139)">
							<path
								className={classes.svg_sun}
								d="m 255.996,127.577 c -70.925,0 -128.42,57.495 -128.42,128.42 0,70.933 57.496,128.428 128.42,128.428 70.924,0 128.428,-57.495 128.428,-128.428 0,-70.925 -57.503,-128.42 -128.428,-128.42 z"
								id="path1"
							/>
							<path
								className={classes.svg_sun}
								d="M 512,255.996 C 433.891,206.954 413.948,162.486 436.935,75.064 349.521,98.059 305.045,78.1 255.996,0.007 206.954,78.1 162.486,98.059 75.064,75.064 98.06,162.487 78.109,206.954 0,255.996 c 78.109,49.049 98.06,93.525 75.065,180.939 87.422,-22.987 131.89,-3.036 180.932,75.057 49.049,-78.093 93.525,-98.044 180.939,-75.057 C 413.948,349.522 433.891,305.046 512,255.996 Z m -256.004,167.77 c -92.666,0 -167.762,-75.112 -167.762,-167.77 0,-92.65 75.096,-167.762 167.762,-167.762 92.65,0 167.769,75.112 167.769,167.762 0.001,92.658 -75.119,167.77 -167.769,167.77 z"
								id="path2"
							/>
						</g>
						<path
							d="m 213.08682,39.34943 c -13.07153,0 -23.65625,10.615967 -23.65625,23.6875 0,0.343533 -0.0144,0.691284 0,1.03125 -3.32738,1.210585 -5.6875,4.379125 -5.6875,8.125 0,4.78675 3.8695,8.6875 8.65625,8.6875 1.46134,0 2.85473,-0.36132 4.0625,-1 4.27418,4.21927 10.14461,6.8125 16.625,6.8125 h 50.84375 c 7.64041,0 13.81251,-6.17209 13.81251,-13.8125 0,-7.640405 -6.1721,-13.84375 -13.81251,-13.84375 -2.38762,0 -4.63353,0.62265 -6.59375,1.6875 -1.59054,-6.870021 -7.74014,-12.03125 -15.09375,-12.03125 -3.18854,0 -6.12974,0.974373 -8.59375,2.625 -4.07613,-7.136244 -11.75572,-11.96875 -20.5625,-11.96875 z"
							id="path3"
							style={{ fill: "#ffffff", stroke: "#555" }}
						/>
						<g className={classes.svg_text}>
							<path
								d="m 43.037109,60.425686 q -4.21875,2.050781 -8.759765,3.076172 -4.541016,1.02539 -9.375,1.02539 -10.927735,0 -17.3144534,-6.09375 -6.3867187,-6.123046 -6.3867187,-16.582031 0,-10.576172 6.5039062,-16.640625 6.5039059,-6.064453 17.8124999,-6.064453 4.365234,0 8.349609,0.820313 4.013672,0.820312 7.558594,2.43164 v 9.052735 q -3.662109,-2.080079 -7.294922,-3.105469 -3.603515,-1.025391 -7.236328,-1.025391 -6.738281,0 -10.40039,3.779297 -3.632813,3.75 -3.632813,10.751953 0,6.94336 3.515625,10.722656 3.515625,3.779297 9.990234,3.779297 1.757813,0 3.251954,-0.205078 1.523437,-0.234375 2.724609,-0.703125 V 46.949123 H 25.458984 V 39.39053 H 43.037109 Z M 68.115234,37.574123 q -3.486328,0 -5.332031,2.519532 -1.816406,2.490234 -1.816406,7.207031 0,4.716797 1.816406,7.236328 1.845703,2.490234 5.332031,2.490234 3.427735,0 5.244141,-2.490234 1.816406,-2.519531 1.816406,-7.236328 0,-4.716797 -1.816406,-7.207031 -1.816406,-2.519532 -5.244141,-2.519532 z m 0,-7.5 q 8.466797,0 13.212891,4.570313 4.775391,4.570312 4.775391,12.65625 0,8.085937 -4.775391,12.65625 -4.746094,4.570312 -13.212891,4.570312 -8.496093,0 -13.300781,-4.570312 -4.775391,-4.570313 -4.775391,-12.65625 0,-8.085938 4.775391,-12.65625 4.804688,-4.570313 13.300781,-4.570313 z m 41.220706,7.5 q -3.48633,0 -5.33203,2.519532 -1.81641,2.490234 -1.81641,7.207031 0,4.716797 1.81641,7.236328 1.8457,2.490234 5.33203,2.490234 3.42773,0 5.24414,-2.490234 1.8164,-2.519531 1.8164,-7.236328 0,-4.716797 -1.8164,-7.207031 -1.81641,-2.519532 -5.24414,-2.519532 z m 0,-7.5 q 8.46679,0 13.21289,4.570313 4.77539,4.570312 4.77539,12.65625 0,8.085937 -4.77539,12.65625 -4.7461,4.570312 -13.21289,4.570312 -8.4961,0 -13.300784,-4.570312 -4.77539,-4.570313 -4.77539,-12.65625 0,-8.085938 4.77539,-12.65625 4.804684,-4.570313 13.300784,-4.570313 z m 47.92968,5.595704 V 18.091702 h 10.54688 v 45.585937 h -10.54688 v -4.746094 q -2.16796,2.900391 -4.77539,4.248047 -2.60742,1.347656 -6.03515,1.347656 -6.06446,0 -9.96094,-4.804687 -3.89648,-4.833984 -3.89648,-12.421875 0,-7.587891 3.89648,-12.392578 3.89648,-4.833985 9.96094,-4.833985 3.39844,0 6.00586,1.376954 2.63672,1.347656 4.80468,4.21875 z m -6.91406,21.240234 q 3.36914,0 5.12696,-2.460938 1.7871,-2.460937 1.7871,-7.148437 0,-4.6875 -1.7871,-7.148438 -1.75782,-2.460937 -5.12696,-2.460937 -3.33984,0 -5.12695,2.460937 -1.75781,2.460938 -1.75781,7.148438 0,4.6875 1.75781,7.148437 1.78711,2.460938 5.12695,2.460938 z"
								id="path9"
							/>
							<path
								d="m 0,87.968904 h 10.810547 l 7.558594,31.787106 7.5,-31.787106 h 10.86914 l 7.5,31.787106 7.558594,-31.787106 h 10.722656 l -10.3125,43.740236 H 39.199219 L 31.259766,98.457185 23.408203,131.70914 H 10.400391 Z M 100.04883,115.215 v 2.98828 H 75.527344 q 0.380859,3.69141 2.666015,5.53711 2.285157,1.8457 6.386719,1.8457 3.310547,0 6.767578,-0.9668 3.486328,-0.99609 7.148438,-2.98828 v 8.08594 q -3.720703,1.40625 -7.441407,2.10938 -3.720703,0.73242 -7.441406,0.73242 -8.90625,0 -13.857422,-4.51172 -4.921875,-4.54102 -4.921875,-12.71484 0,-8.02735 4.833985,-12.62696 4.863281,-4.599607 13.359375,-4.599607 7.734375,0 12.363281,4.658207 4.658205,4.6582 4.658205,12.45117 z m -10.781252,-3.48633 q 0,-2.98828 -1.757812,-4.80469 -1.728516,-1.8457 -4.541016,-1.8457 -3.046875,0 -4.951172,1.72851 -1.904297,1.69922 -2.373047,4.92188 z m 33.427732,5.21484 q -3.28125,0 -4.95117,1.11328 -1.64062,1.11329 -1.64062,3.28125 0,1.99219 1.31836,3.13477 1.34765,1.11328 3.7207,1.11328 2.95898,0 4.98047,-2.10937 2.02148,-2.13868 2.02148,-5.33203 v -1.20118 z m 16.02539,-3.95507 v 18.7207 h -10.57617 v -4.86328 q -2.10937,2.98828 -4.74609,4.36523 -2.63672,1.34766 -6.41602,1.34766 -5.09765,0 -8.29101,-2.95899 -3.16407,-2.98828 -3.16407,-7.73437 0,-5.77149 3.95508,-8.4668 3.98438,-2.69531 12.48047,-2.69531 h 6.18164 v -0.82031 q 0,-2.49024 -1.96289,-3.63282 -1.96289,-1.17187 -6.12305,-1.17187 -3.36914,0 -6.26953,0.67383 -2.90039,0.67383 -5.39062,2.02148 v -7.998045 q 3.36914,-0.820313 6.76758,-1.230469 3.39843,-0.439453 6.79687,-0.439453 8.87695,0 12.80273,3.515627 3.95508,3.48633 3.95508,11.36719 z m 21.21094,-23.408208 v 9.316406 h 10.81055 v 7.500002 h -10.81055 v 13.91601 q 0,2.28516 0.9082,3.10547 0.90821,0.79102 3.60352,0.79102 h 5.39062 v 7.5 h -8.99414 q -6.21093,0 -8.81836,-2.57813 -2.57812,-2.60742 -2.57812,-8.81836 v -13.91601 h -5.21484 v -7.500002 h 5.21484 v -9.316406 z m 50.21484,22.148438 v 19.98047 h -10.54687 v -3.25195 -11.98243 q 0,-4.30664 -0.20508,-5.91797 -0.17578,-1.61132 -0.64453,-2.37304 -0.61523,-1.02539 -1.66992,-1.58203 -1.05469,-0.58594 -2.40235,-0.58594 -3.28125,0 -5.15625,2.54883 -1.875,2.51953 -1.875,7.00195 v 16.14258 H 177.1582 V 86.123201 h 10.48828 v 17.578129 q 2.37305,-2.8711 5.03907,-4.218754 2.66601,-1.376953 5.88867,-1.376953 5.68359,0 8.61328,3.486327 2.95898,3.48633 2.95898,10.13672 z m 42.48047,3.48633 v 2.98828 h -24.52148 q 0.38086,3.69141 2.66601,5.53711 2.28516,1.8457 6.38672,1.8457 3.31055,0 6.76758,-0.9668 3.48633,-0.99609 7.14844,-2.98828 v 8.08594 q -3.7207,1.40625 -7.44141,2.10938 -3.7207,0.73242 -7.4414,0.73242 -8.90625,0 -13.85743,-4.51172 -4.92187,-4.54102 -4.92187,-12.71484 0,-8.02735 4.83398,-12.62696 4.86328,-4.599607 13.35938,-4.599607 7.73437,0 12.36328,4.658207 4.6582,4.6582 4.6582,12.45117 z m -10.78125,-3.48633 q 0,-2.98828 -1.75781,-4.80469 -1.72852,-1.8457 -4.54102,-1.8457 -3.04687,0 -4.95117,1.72851 -1.90429,1.69922 -2.37304,4.92188 z m 43.09571,-3.89648 q -1.37696,-0.64454 -2.75391,-0.9375 -1.34766,-0.32227 -2.72461,-0.32227 -4.04297,0 -6.24023,2.60742 -2.16797,2.57813 -2.16797,7.41211 v 15.11719 H 260.56641 V 98.896638 h 10.48828 v 5.390622 q 2.02148,-3.22265 4.6289,-4.687497 2.63672,-1.49414 6.29883,-1.49414 0.52735,0 1.14258,0.05859 0.61523,0.0293 1.78711,0.175781 z"
								id="path10"
							/>
						</g>
					</svg>
				</div>
				<MainMenu />
			</div>
			<div className={classes.city} onClick={() => setIsModalOpen(true)}>
				{citySetting.name}
			</div>
			{isModalOpen ? <SearchCity changeCity={setCitySetting} modalOpen={setIsModalOpen} /> : null}
		</header>
	);
};

export default Header;
